# üçé –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ Apple Pay

## ‚úÖ –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

### **1. –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API:**
- ‚úÖ `/api/v1/auth/apple/generate-account` - —Å–æ–∑–¥–∞–Ω–∏–µ Apple –∞–∫–∫–∞—É–Ω—Ç–∞
- ‚úÖ `/api/v1/payments/add-payment-method` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ payment –º–µ—Ç–æ–¥–∞
- ‚úÖ `/api/v1/payments/subscription/create-subscription-transaction-v2` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏
- ‚úÖ `/api/v1/payments/rent-power-bank` - –∞—Ä–µ–Ω–¥–∞ –ø–∞–≤–µ—Ä–±–∞–Ω–∫–∞

### **2. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π flow –ø–ª–∞—Ç–µ–∂–µ–π:**
```
1. –ü–æ–ª—É—á–∏—Ç—å Braintree client token
2. –°–æ–∑–¥–∞—Ç—å Apple –∞–∫–∫–∞—É–Ω—Ç
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å Apple Pay ‚Üí –ø–æ–ª—É—á–∏—Ç—å nonce
4. –î–æ–±–∞–≤–∏—Ç—å payment method ‚Üí –ø–æ–ª—É—á–∏—Ç—å paymentToken
5. –°–æ–∑–¥–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É —Å paymentToken
6. –ê—Ä–µ–Ω–¥–æ–≤–∞—Ç—å –ø–∞–≤–µ—Ä–±–∞–Ω–∫ —Å paymentToken
```

### **3. –ù–∞—Å—Ç–æ—è—â–∏–π Apple Pay:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π Apple Pay JS API
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å Braintree
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è merchant validation
- ‚úÖ –ù–∞—Å—Ç–æ—è—â–∏–µ Apple Pay –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–ª—è —Ä–∞–±–æ—Ç—ã:

### **1. Apple Pay Domain Verification:**
```html
<!-- –í web/index.html –∑–∞–º–µ–Ω–∏—Ç—å -->
<meta name="apple-pay-domain-verification" content="YOUR_DOMAIN_VERIFICATION_CODE">
```

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å:**
1. –û–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ @kareemnba –≤ Telegram
2. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –¥–æ–º–µ–Ω –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. –ü–æ–ª—É—á–∏—Ç—å verification code –æ—Ç Apple
4. –î–æ–±–∞–≤–∏—Ç—å –≤ HTML

### **2. Backend —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è merchant validation:**
–ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–∞ backend:
```
POST /api/v1/payments/validate-merchant
Body: { "validationURL": "https://..." }
Response: { merchant session data }
```

### **3. CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ backend —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —Å –≤–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞.

### **4. Braintree Configuration:**
- –í–∫–ª—é—á–∏—Ç—å Apple Pay –≤ Braintree Dashboard
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å merchant ID
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API –∫–ª—é—á–∏

## üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### **–ù–∞ iPhone —Å Apple Pay:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "Apple Pay"
2. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è **–Ω–∞—Å—Ç–æ—è—â–µ–µ** Apple Pay –æ–∫–Ω–æ –æ—Ç Apple
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –∫–∞—Ä—Ç—É –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç Touch ID/Face ID
4. –ü–æ–ª—É—á–∞–µ—Ç—Å—è nonce –æ—Ç Braintree
5. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ backend –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
6. –°–æ–∑–¥–∞–µ—Ç—Å—è –ø–æ–¥–ø–∏—Å–∫–∞ –∏ –∞—Ä–µ–Ω–¥–∞ –ø–∞–≤–µ—Ä–±–∞–Ω–∫–∞

### **–ù–∞ –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "Debit or credit card"
2. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è Braintree Drop-in
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã
4. –ü–æ–ª—É—á–∞–µ—Ç—Å—è nonce –æ—Ç Braintree
5. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ backend –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

## üì± –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

### **–ù–∞ iPhone:**
- –û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç –≤ Safari
- –ù–∞–∂–º–∏—Ç–µ "Apple Pay"
- –£–≤–∏–¥–∏—Ç–µ –Ω–∞—Å—Ç–æ—è—â–µ–µ Apple Pay –æ–∫–Ω–æ
- –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ Touch ID/Face ID

### **–ù–∞ –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö:**
- –ù–∞–∂–º–∏—Ç–µ "Debit or credit card"
- –£–≤–∏–¥–∏—Ç–µ Braintree Drop-in
- –í–≤–µ–¥–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

- ‚úÖ –í—Å–µ –ø–ª–∞—Ç–µ–∂–∏ —á–µ—Ä–µ–∑ Braintree (PCI DSS compliant)
- ‚úÖ Apple Pay –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Touch ID/Face ID
- ‚úÖ Merchant validation —á–µ—Ä–µ–∑ Apple
- ‚úÖ HTTPS –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
- ‚úÖ JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## üìã –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞:

- [ ] –î–æ–º–µ–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å HTTPS
- [ ] Apple Pay domain verification –ø–æ–ª—É—á–µ–Ω
- [ ] Backend —ç–Ω–¥–ø–æ–∏–Ω—Ç `/api/v1/payments/validate-merchant` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- [ ] CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –≤–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞
- [ ] Braintree Apple Pay –≤–∫–ª—é—á–µ–Ω
- [ ] API –∫–ª—é—á–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã

---

**–ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å —É –≤–∞—Å –Ω–∞—Å—Ç–æ—è—â–∏–π Apple Pay —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º API! üçé‚ú®**
